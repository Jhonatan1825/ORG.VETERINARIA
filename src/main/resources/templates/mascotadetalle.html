<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Detalle de Mascota</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
<div class="container mt-5">

    <h2 class="mb-4">Detalle de Mascota</h2>

    <!-- Información de la mascota -->
    <div class="card mb-4">
        <div class="row g-0">
            <div class="col-md-4">
                <img th:src="@{'/img_mascotas/' + ${mascota.imagen}}"
                     class="img-fluid rounded-start"
                     alt="Imagen de la mascota"
                     onerror="this.onerror=null;this.src='/img/mascota_default.jpg';">
            </div>
            <div class="col-md-8">
                <div class="card-body">
                    <h5 class="card-title" th:text="${mascota.nombre}">Nombre</h5>
                    <p class="card-text">
                        <strong>Edad:</strong> <span th:text="${mascota.edad}"></span> años<br>
                        <strong>Especie:</strong> <span th:text="${mascota.especie}"></span><br>
                        <strong>Raza:</strong> <span th:text="${mascota.raza}"></span><br>
                        <strong>Género:</strong> <span th:text="${mascota.genero}"></span><br>
                        <strong>Alergias:</strong> <span th:text="${mascota.alergias} ?: 'No registra'"></span><br>
                        <strong>Comportamiento:</strong> <span th:text="${mascota.comportamiento} ?: 'No registrado'"></span><br>
                    </p>
                    <hr>
                    <p class="card-text">
                        <strong>Dueño:</strong> <span th:text="${mascota.cliente.nombre + ' ' + mascota.cliente.apellido}"></span><br>
                        <strong>DNI:</strong> <span th:text="${mascota.cliente.dni}"></span><br>
                        <strong>Teléfono:</strong> <span th:text="${mascota.cliente.telefono}"></span><br>
                        <strong>Dirección:</strong> <span th:text="${mascota.cliente.direcion}"></span>
                    </p>
                </div>
            </div>
        </div>
    </div>

    <!-- Diagnósticos -->
    <h4>Diagnósticos</h4>
    <div th:if="${#lists.isEmpty(diagnosticos)}" class="alert alert-warning">
        No hay diagnósticos registrados.
    </div>
    <ul class="list-group mb-4" th:if="${!#lists.isEmpty(diagnosticos)}">
        <li class="list-group-item" th:each="diag : ${diagnosticos}">
            <strong th:text="${#dates.format(diag.fecha, 'dd/MM/yyyy')}">Fecha</strong> – 
            <span th:text="${diag.descripcion}">Diagnóstico</span>
            <span class="badge bg-info text-dark ms-2" th:text="${diag.estado}">Estado</span>
        </li>
    </ul>

    <!-- Citas -->
    <h4>Historial de Citas</h4>
    <div th:if="${#lists.isEmpty(citas)}" class="alert alert-secondary">
        No hay citas registradas para esta mascota.
    </div>
    <table class="table table-bordered" th:if="${!#lists.isEmpty(citas)}">
        <thead class="table-light">
            <tr>
                <th>Fecha</th>
                <th>Motivo</th>
                <th>Servicio</th>
                <th>Veterinario</th>
                <th>Costo</th>
            </tr>
        </thead>
        <tbody>
            <tr th:each="cita : ${citas}">
                <td th:text="${#dates.format(cita.fecha, 'dd/MM/yyyy HH:mm')}">-</td>
                <td th:text="${cita.motivo}">-</td>
                <td th:text="${cita.servicio.nombreServicio}">-</td>
                <td th:text="${cita.veterinario.nombre}">-</td>
                <td th:text="${cita.servicio.costo}">-</td>
            </tr>
        </tbody>
    </table>

    <div class="text-end">
        <a href="/mascotas" class="btn btn-secondary">
            ← Volver al listado
        </a>
    </div>

</div>
</body>
</html>
